(function(a,b){function c(j,l){this.currentView=0,this.minDate,this.maxDate,this._attachedEvents=[],this.element=j,this.$element=a(j),this.params={date:!0,time:!0,format:"YYYY-MM-DD",minDate:null,maxDate:null,currentDate:null,lang:"en",weekStart:0,disabledDays:[],shortTime:!1,clearButton:!1,nowButton:!1,cancelText:"Cancel",okText:"OK",clearText:"Clear",nowText:"Now",switchOnClick:!1,triggerEvent:"focus",monthPicker:!1,year:!0},this.params=a.fn.extend(this.params,l),this.name="dtp_"+this.setName(),this.$element.attr("data-dtp",this.name),b.locale(this.params.lang),this.init()}var f="bootstrapMaterialDatePicker",g="plugin_"+f;b.locale("en"),a.fn[f]=function(j,l){return this.each(function(){a.data(this,g)?("function"==typeof a.data(this,g)[j]&&a.data(this,g)[j](l),"destroy"===j&&delete a.data(this,g)):a.data(this,g,new c(this,j))}),this},c.prototype={init:function(){this.initDays(),this.initDates(),this.initTemplate(),this.initButtons(),this._attachEvent(a(window),"resize",this._centerBox.bind(this)),this._attachEvent(this.$dtpElement.find(".dtp-content"),"click",this._onElementClick.bind(this)),this._attachEvent(this.$dtpElement,"click",this._onBackgroundClick.bind(this)),this._attachEvent(this.$dtpElement.find(".dtp-close > a"),"click",this._onCloseClick.bind(this)),this._attachEvent(this.$element,this.params.triggerEvent,this._fireCalendar.bind(this))},initDays:function(){this.days=[];for(var j=this.params.weekStart;7>this.days.length;j++)6<j&&(j=0),this.days.push(j.toString())},initDates:function(){if(0<this.$element.val().length)this.currentDate="undefined"!=typeof this.params.format&&null!==this.params.format?b(this.$element.val(),this.params.format).locale(this.params.lang):b(this.$element.val()).locale(this.params.lang);else if("undefined"!=typeof this.$element.attr("value")&&null!==this.$element.attr("value")&&""!==this.$element.attr("value"))"string"==typeof this.$element.attr("value")&&("undefined"!=typeof this.params.format&&null!==this.params.format?this.currentDate=b(this.$element.attr("value"),this.params.format).locale(this.params.lang):this.currentDate=b(this.$element.attr("value")).locale(this.params.lang));else if("undefined"!=typeof this.params.currentDate&&null!==this.params.currentDate){if("string"==typeof this.params.currentDate)this.currentDate="undefined"!=typeof this.params.format&&null!==this.params.format?b(this.params.currentDate,this.params.format).locale(this.params.lang):b(this.params.currentDate).locale(this.params.lang);else if("undefined"==typeof this.params.currentDate.isValid||"function"!=typeof this.params.currentDate.isValid){var j=this.params.currentDate.getTime();this.currentDate=b(j,"x").locale(this.params.lang)}else this.currentDate=this.params.currentDate;this.$element.val(this.currentDate.format(this.params.format))}else this.currentDate=b();if("undefined"==typeof this.params.minDate||null===this.params.minDate)null===this.params.minDate&&(this.minDate=null);else if("string"==typeof this.params.minDate)this.minDate="undefined"!=typeof this.params.format&&null!==this.params.format?b(this.params.minDate,this.params.format).locale(this.params.lang):b(this.params.minDate).locale(this.params.lang);else if("undefined"==typeof this.params.minDate.isValid||"function"!=typeof this.params.minDate.isValid){var j=this.params.minDate.getTime();this.minDate=b(j,"x").locale(this.params.lang)}else this.minDate=this.params.minDate;if("undefined"==typeof this.params.maxDate||null===this.params.maxDate)null===this.params.maxDate&&(this.maxDate=null);else if("string"==typeof this.params.maxDate)this.maxDate="undefined"!=typeof this.params.format&&null!==this.params.format?b(this.params.maxDate,this.params.format).locale(this.params.lang):b(this.params.maxDate).locale(this.params.lang);else if("undefined"==typeof this.params.maxDate.isValid||"function"!=typeof this.params.maxDate.isValid){var j=this.params.maxDate.getTime();this.maxDate=b(j,"x").locale(this.params.lang)}else this.maxDate=this.params.maxDate;this.isAfterMinDate(this.currentDate)||(this.currentDate=b(this.minDate)),this.isBeforeMaxDate(this.currentDate)||(this.currentDate=b(this.maxDate))},initTemplate:function(){for(var j="",l=this.currentDate.year(),n=l-3;n<l+4;n++)j+="<div class=\"year-picker-item\" data-year=\""+n+"\">"+n+"</div>";this.midYear=l;var o="<div class=\"dtp-picker-year hidden\" ><div><a href=\"javascript:void(0);\" class=\"btn btn-default dtp-select-year-range before\" style=\"margin: 0;\"><i class=\"material-icons\">keyboard_arrow_up</i></a></div>"+j+"<div><a href=\"javascript:void(0);\" class=\"btn btn-default dtp-select-year-range after\" style=\"margin: 0;\"><i class=\"material-icons\">keyboard_arrow_down</i></a></div></div>";this.template="<div class=\"dtp hidden\" id=\""+this.name+"\"><div class=\"dtp-content\"><div class=\"dtp-date-view\"><header class=\"dtp-header\"><div class=\"dtp-actual-day\">Lundi</div><div class=\"dtp-close\"><a href=\"javascript:void(0);\"><i class=\"material-icons\">clear</i></a></div></header><div class=\"dtp-date hidden\"><div><div class=\"left center p10\"><a href=\"javascript:void(0);\" class=\"dtp-select-month-before\"><i class=\"material-icons\">chevron_left</i></a></div><div class=\"dtp-actual-month p80\">MAR</div><div class=\"right center p10\"><a href=\"javascript:void(0);\" class=\"dtp-select-month-after\"><i class=\"material-icons\">chevron_right</i></a></div><div class=\"clearfix\"></div></div><div class=\"dtp-actual-num\">13</div><div><div class=\"left center p10\"><a href=\"javascript:void(0);\" class=\"dtp-select-year-before\"><i class=\"material-icons\">chevron_left</i></a></div><div class=\"dtp-actual-year p80"+(this.params.year?"":" disabled")+"\">2014</div><div class=\"right center p10\"><a href=\"javascript:void(0);\" class=\"dtp-select-year-after\"><i class=\"material-icons\">chevron_right</i></a></div><div class=\"clearfix\"></div></div></div><div class=\"dtp-time hidden\"><div class=\"dtp-actual-maxtime\">23:55</div></div><div class=\"dtp-picker\"><div class=\"dtp-picker-calendar\"></div><div class=\"dtp-picker-datetime hidden\"><div class=\"dtp-actual-meridien\"><div class=\"left p20\"><a class=\"dtp-meridien-am\" href=\"javascript:void(0);\">AM</a></div><div class=\"dtp-actual-time p60\"></div><div class=\"right p20\"><a class=\"dtp-meridien-pm\" href=\"javascript:void(0);\">PM</a></div><div class=\"clearfix\"></div></div><div id=\"dtp-svg-clock\"></div></div>"+o+"</div></div><div class=\"dtp-buttons\"><button class=\"dtp-btn-now btn btn-flat hidden\">"+this.params.nowText+"</button><button class=\"dtp-btn-clear btn btn-flat hidden\">"+this.params.clearText+"</button><button class=\"dtp-btn-cancel btn btn-flat\">"+this.params.cancelText+"</button><button class=\"dtp-btn-ok btn btn-flat\">"+this.params.okText+"</button><div class=\"clearfix\"></div></div></div></div>",0>=a("body").find("#"+this.name).length&&(a("body").append(this.template),this&&(this.dtpElement=a("body").find("#"+this.name)),this.$dtpElement=a(this.dtpElement))},initButtons:function(){this._attachEvent(this.$dtpElement.find(".dtp-btn-cancel"),"click",this._onCancelClick.bind(this)),this._attachEvent(this.$dtpElement.find(".dtp-btn-ok"),"click",this._onOKClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-month-before"),"click",this._onMonthBeforeClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-month-after"),"click",this._onMonthAfterClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-year-before"),"click",this._onYearBeforeClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-year-after"),"click",this._onYearAfterClick.bind(this)),this._attachEvent(this.$dtpElement.find(".dtp-actual-year"),"click",this._onActualYearClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-year-range.before"),"click",this._onYearRangeBeforeClick.bind(this)),this._attachEvent(this.$dtpElement.find("a.dtp-select-year-range.after"),"click",this._onYearRangeAfterClick.bind(this)),this._attachEvent(this.$dtpElement.find("div.year-picker-item"),"click",this._onYearItemClick.bind(this)),!0===this.params.clearButton&&(this._attachEvent(this.$dtpElement.find(".dtp-btn-clear"),"click",this._onClearClick.bind(this)),this.$dtpElement.find(".dtp-btn-clear").removeClass("hidden")),!0===this.params.nowButton&&(this._attachEvent(this.$dtpElement.find(".dtp-btn-now"),"click",this._onNowClick.bind(this)),this.$dtpElement.find(".dtp-btn-now").removeClass("hidden")),!0===this.params.nowButton&&!0===this.params.clearButton?this.$dtpElement.find(".dtp-btn-clear, .dtp-btn-now, .dtp-btn-cancel, .dtp-btn-ok").addClass("btn-xs"):(!0===this.params.nowButton||!0===this.params.clearButton)&&this.$dtpElement.find(".dtp-btn-clear, .dtp-btn-now, .dtp-btn-cancel, .dtp-btn-ok").addClass("btn-sm")},initMeridienButtons:function(){this.$dtpElement.find("a.dtp-meridien-am").off("click").on("click",this._onSelectAM.bind(this)),this.$dtpElement.find("a.dtp-meridien-pm").off("click").on("click",this._onSelectPM.bind(this))},initDate:function(){this.currentView=0,!1===this.params.monthPicker&&this.$dtpElement.find(".dtp-picker-calendar").removeClass("hidden"),this.$dtpElement.find(".dtp-picker-datetime").addClass("hidden"),this.$dtpElement.find(".dtp-picker-year").addClass("hidden");var l="undefined"!=typeof this.currentDate&&null!==this.currentDate?this.currentDate:null,n=this.generateCalendar(this.currentDate);if("undefined"!=typeof n.week&&"undefined"!=typeof n.days){var o=this.constructHTMLCalendar(l,n);this.$dtpElement.find("a.dtp-select-day").off("click"),this.$dtpElement.find(".dtp-picker-calendar").html(o),this.$dtpElement.find("a.dtp-select-day").on("click",this._onSelectDate.bind(this)),this.toggleButtons(l)}this._centerBox(),this.showDate(l)},initHours:function(){this.currentView=1,this.showTime(this.currentDate),this.initMeridienButtons(),12>this.currentDate.hour()?this.$dtpElement.find("a.dtp-meridien-am").click():this.$dtpElement.find("a.dtp-meridien-pm").click();var j=this.params.shortTime?"h":"H";this.$dtpElement.find(".dtp-picker-datetime").removeClass("hidden"),this.$dtpElement.find(".dtp-picker-calendar").addClass("hidden"),this.$dtpElement.find(".dtp-picker-year").addClass("hidden");for(var l=this.createSVGClock(!0),n=0;12>n;n++){var o=-(162*Math.sin(2*-Math.PI*(n/12))),q=-(162*Math.cos(2*-Math.PI*(n/12))),t=this.currentDate.format(j)==n?"#8BC34A":"transparent",u=this.currentDate.format(j)==n?"#fff":"#000",v=this.createSVGElement("circle",{id:"h-"+n,"class":"dtp-select-hour",style:"cursor:pointer",r:"30",cx:o,cy:q,fill:t,"data-hour":n}),w=this.createSVGElement("text",{id:"th-"+n,"class":"dtp-select-hour-text","text-anchor":"middle",style:"cursor:pointer","font-weight":"bold","font-size":"20",x:o,y:q+7,fill:u,"data-hour":n});w.textContent=0===n?this.params.shortTime?12:n:n,this.toggleTime(n,!0)?(v.addEventListener("click",this._onSelectHour.bind(this)),w.addEventListener("click",this._onSelectHour.bind(this))):(v.className+=" disabled",w.className+=" disabled",w.setAttribute("fill","#bdbdbd")),l.appendChild(v),l.appendChild(w)}if(!this.params.shortTime){for(var n=0;12>n;n++){var o=-(110*Math.sin(2*-Math.PI*(n/12))),q=-(110*Math.cos(2*-Math.PI*(n/12))),t=this.currentDate.format(j)==n+12?"#8BC34A":"transparent",u=this.currentDate.format(j)==n+12?"#fff":"#000",v=this.createSVGElement("circle",{id:"h-"+(n+12),"class":"dtp-select-hour",style:"cursor:pointer",r:"30",cx:o,cy:q,fill:t,"data-hour":n+12}),w=this.createSVGElement("text",{id:"th-"+(n+12),"class":"dtp-select-hour-text","text-anchor":"middle",style:"cursor:pointer","font-weight":"bold","font-size":"22",x:o,y:q+7,fill:u,"data-hour":n+12});w.textContent=n+12,this.toggleTime(n+12,!0)?(v.addEventListener("click",this._onSelectHour.bind(this)),w.addEventListener("click",this._onSelectHour.bind(this))):(v.className+=" disabled",w.className+=" disabled",w.setAttribute("fill","#bdbdbd")),l.appendChild(v),l.appendChild(w)}this.$dtpElement.find("a.dtp-meridien-am").addClass("hidden"),this.$dtpElement.find("a.dtp-meridien-pm").addClass("hidden")}this._centerBox()},initMinutes:function(){this.currentView=2,this.showTime(this.currentDate),this.initMeridienButtons(),12>this.currentDate.hour()?this.$dtpElement.find("a.dtp-meridien-am").click():this.$dtpElement.find("a.dtp-meridien-pm").click(),this.$dtpElement.find(".dtp-picker-year").addClass("hidden"),this.$dtpElement.find(".dtp-picker-calendar").addClass("hidden"),this.$dtpElement.find(".dtp-picker-datetime").removeClass("hidden");for(var j=this.createSVGClock(!1),l=0;60>l;l++){var n=0==l%5?162:158,o=0==l%5?30:20,q=-(n*Math.sin(2*-Math.PI*(l/60))),t=-(n*Math.cos(2*-Math.PI*(l/60))),u=this.currentDate.format("m")==l?"#8BC34A":"transparent",v=this.createSVGElement("circle",{id:"m-"+l,"class":"dtp-select-minute",style:"cursor:pointer",r:o,cx:q,cy:t,fill:u,"data-minute":l});this.toggleTime(l,!1)?v.addEventListener("click",this._onSelectMinute.bind(this)):v.className+=" disabled",j.appendChild(v)}for(var l=0;60>l;l++)if(0==l%5){var q=-(162*Math.sin(2*-Math.PI*(l/60))),t=-(162*Math.cos(2*-Math.PI*(l/60))),u=this.currentDate.format("m")==l?"#fff":"#000",w=this.createSVGElement("text",{id:"tm-"+l,"class":"dtp-select-minute-text","text-anchor":"middle",style:"cursor:pointer","font-weight":"bold","font-size":"20",x:q,y:t+7,fill:u,"data-minute":l});w.textContent=l,this.toggleTime(l,!1)?w.addEventListener("click",this._onSelectMinute.bind(this)):(w.className+=" disabled",w.setAttribute("fill","#bdbdbd")),j.appendChild(w)}this._centerBox()},animateHands:function(){var j=this.currentDate.hour(),l=this.currentDate.minute(),n=this.$dtpElement.find(".hour-hand");n[0].setAttribute("transform","rotate("+360*j/12+")");var o=this.$dtpElement.find(".minute-hand");o[0].setAttribute("transform","rotate("+360*l/60+")")},createSVGClock:function(j){var l=this.params.shortTime?-120:-90,n=this.createSVGElement("svg",{class:"svg-clock",viewBox:"0,0,400,400"}),o=this.createSVGElement("g",{transform:"translate(200,200) "}),q=this.createSVGElement("circle",{r:"192",fill:"#eee",stroke:"#bdbdbd","stroke-width":2}),t=this.createSVGElement("circle",{r:"15",fill:"#757575"});if(o.appendChild(q),j){var u=this.createSVGElement("line",{class:"minute-hand",x1:0,y1:0,x2:0,y2:-150,stroke:"#bdbdbd","stroke-width":2}),v=this.createSVGElement("line",{class:"hour-hand",x1:0,y1:0,x2:0,y2:l,stroke:"#8BC34A","stroke-width":8});o.appendChild(u),o.appendChild(v)}else{var u=this.createSVGElement("line",{class:"minute-hand",x1:0,y1:0,x2:0,y2:-150,stroke:"#8BC34A","stroke-width":2}),v=this.createSVGElement("line",{class:"hour-hand",x1:0,y1:0,x2:0,y2:l,stroke:"#bdbdbd","stroke-width":8});o.appendChild(v),o.appendChild(u)}return o.appendChild(t),n.appendChild(o),this.$dtpElement.find("#dtp-svg-clock").empty(),this.$dtpElement.find("#dtp-svg-clock")[0].appendChild(n),this.animateHands(),o},createSVGElement:function(j,l){var n=document.createElementNS("http://www.w3.org/2000/svg",j);for(var o in l)n.setAttribute(o,l[o]);return n},isAfterMinDate:function(j,l,n){var o=!0;if("undefined"!=typeof this.minDate&&null!==this.minDate){var q=b(this.minDate),t=b(j);l||n||(q.hour(0),q.minute(0),t.hour(0),t.minute(0)),q.second(0),t.second(0),q.millisecond(0),t.millisecond(0),n?o=parseInt(t.format("X"))>=parseInt(q.format("X")):(t.minute(0),q.minute(0),o=parseInt(t.format("X"))>=parseInt(q.format("X")))}return o},isBeforeMaxDate:function(j,l,n){var o=!0;if("undefined"!=typeof this.maxDate&&null!==this.maxDate){var q=b(this.maxDate),t=b(j);l||n||(q.hour(0),q.minute(0),t.hour(0),t.minute(0)),q.second(0),t.second(0),q.millisecond(0),t.millisecond(0),n?o=parseInt(t.format("X"))<=parseInt(q.format("X")):(t.minute(0),q.minute(0),o=parseInt(t.format("X"))<=parseInt(q.format("X")))}return o},rotateElement:function(j,l){a(j).css({WebkitTransform:"rotate("+l+"deg)","-moz-transform":"rotate("+l+"deg)"})},showDate:function(j){j&&(this.$dtpElement.find(".dtp-actual-day").html(j.locale(this.params.lang).format("dddd")),this.$dtpElement.find(".dtp-actual-month").html(j.locale(this.params.lang).format("MMM").toUpperCase()),this.$dtpElement.find(".dtp-actual-num").html(j.locale(this.params.lang).format("DD")),this.$dtpElement.find(".dtp-actual-year").html(j.locale(this.params.lang).format("YYYY")))},showTime:function(j){if(j){var l=j.minute(),n=(this.params.shortTime?j.format("hh"):j.format("HH"))+":"+(2==l.toString().length?l:"0"+l)+(this.params.shortTime?" "+j.format("A"):"");this.params.date?this.$dtpElement.find(".dtp-actual-time").html(n):(this.params.shortTime?this.$dtpElement.find(".dtp-actual-day").html(j.format("A")):this.$dtpElement.find(".dtp-actual-day").html("&nbsp;"),this.$dtpElement.find(".dtp-actual-maxtime").html(n))}},selectDate:function(j){j&&(this.currentDate.date(j),this.showDate(this.currentDate),this.$element.trigger("dateSelected",this.currentDate))},generateCalendar:function(j){var l={};if(null!==j){var n=b(j).locale(this.params.lang).startOf("month"),o=b(j).locale(this.params.lang).endOf("month"),q=n.format("d");l.week=this.days,l.days=[];for(var t=n.date();t<=o.date();t++){if(t===n.date()){var u=l.week.indexOf(q.toString());if(0<u)for(var v=0;v<u;v++)l.days.push(0)}l.days.push(b(n).locale(this.params.lang).date(t))}}return l},constructHTMLCalendar:function(j,l){var n="";n+="<div class=\"dtp-picker-month\">"+j.locale(this.params.lang).format("MMMM YYYY")+"</div>",n+="<table class=\"table dtp-picker-days\"><thead>";for(var o=0;o<l.week.length;o++)n+="<th>"+b(parseInt(l.week[o]),"d").locale(this.params.lang).format("dd").substring(0,1)+"</th>";n+="</thead>",n+="<tbody><tr>";for(var o=0;o<l.days.length;o++)0==o%7&&(n+="</tr><tr>"),n+="<td data-date=\""+b(l.days[o]).locale(this.params.lang).format("D")+"\">",0!=l.days[o]&&(n+=!1===this.isBeforeMaxDate(b(l.days[o]),!1,!1)||!1===this.isAfterMinDate(b(l.days[o]),!1,!1)||-1!==this.params.disabledDays.indexOf(l.days[o].isoWeekday())?"<span class=\"dtp-select-day\">"+b(l.days[o]).locale(this.params.lang).format("DD")+"</span>":b(l.days[o]).locale(this.params.lang).format("DD")===b(this.currentDate).locale(this.params.lang).format("DD")?"<a href=\"javascript:void(0);\" class=\"dtp-select-day selected\">"+b(l.days[o]).locale(this.params.lang).format("DD")+"</a>":"<a href=\"javascript:void(0);\" class=\"dtp-select-day\">"+b(l.days[o]).locale(this.params.lang).format("DD")+"</a>",n+="</td>");return n+="</tr></tbody></table>",n},setName:function(){for(var j="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;5>n;n++)j+=l.charAt(Math.floor(Math.random()*l.length));return j},isPM:function(){return this.$dtpElement.find("a.dtp-meridien-pm").hasClass("selected")},setElementValue:function(){this.$element.trigger("beforeChange",this.currentDate),"undefined"!=typeof a.material&&this.$element.removeClass("empty"),this.$element.val(b(this.currentDate).locale(this.params.lang).format(this.params.format)),this.$element.trigger("change",this.currentDate)},toggleButtons:function(j){if(j&&j.isValid()){var l=b(j).locale(this.params.lang).startOf("month"),n=b(j).locale(this.params.lang).endOf("month");this.isAfterMinDate(l,!1,!1)?this.$dtpElement.find("a.dtp-select-month-before").removeClass("invisible"):this.$dtpElement.find("a.dtp-select-month-before").addClass("invisible"),this.isBeforeMaxDate(n,!1,!1)?this.$dtpElement.find("a.dtp-select-month-after").removeClass("invisible"):this.$dtpElement.find("a.dtp-select-month-after").addClass("invisible");var o=b(j).locale(this.params.lang).startOf("year"),q=b(j).locale(this.params.lang).endOf("year");this.isAfterMinDate(o,!1,!1)?this.$dtpElement.find("a.dtp-select-year-before").removeClass("invisible"):this.$dtpElement.find("a.dtp-select-year-before").addClass("invisible"),this.isBeforeMaxDate(q,!1,!1)?this.$dtpElement.find("a.dtp-select-year-after").removeClass("invisible"):this.$dtpElement.find("a.dtp-select-year-after").addClass("invisible")}},toggleTime:function(j,l){var n=!1;if(l){var o=b(this.currentDate);o.hour(this.convertHours(j)).minute(0).second(0),n=!1!==this.isAfterMinDate(o,!0,!1)&&!1!==this.isBeforeMaxDate(o,!0,!1)}else{var o=b(this.currentDate);o.minute(j).second(0),n=!1!==this.isAfterMinDate(o,!0,!0)&&!1!==this.isBeforeMaxDate(o,!0,!0)}return n},_attachEvent:function(j,l,n){j.on(l,null,null,n),this._attachedEvents.push([j,l,n])},_detachEvents:function(){for(var j=this._attachedEvents.length-1;0<=j;j--)this._attachedEvents[j][0].off(this._attachedEvents[j][1],this._attachedEvents[j][2]),this._attachedEvents.splice(j,1)},_fireCalendar:function(){this.currentView=0,this.$element.blur(),this.initDates(),this.show(),this.params.date?(this.$dtpElement.find(".dtp-date").removeClass("hidden"),this.initDate()):this.params.time&&(this.$dtpElement.find(".dtp-time").removeClass("hidden"),this.initHours())},_onBackgroundClick:function(j){j.stopPropagation(),this.hide()},_onElementClick:function(j){j.stopPropagation()},_onKeydown:function(j){27===j.which&&this.hide()},_onCloseClick:function(){this.hide()},_onClearClick:function(){this.currentDate=null,this.$element.trigger("beforeChange",this.currentDate),this.hide(),"undefined"!=typeof a.material&&this.$element.addClass("empty"),this.$element.val(""),this.$element.trigger("change",this.currentDate)},_onNowClick:function(){if(this.currentDate=b(),!0===this.params.date&&(this.showDate(this.currentDate),0===this.currentView&&this.initDate()),!0===this.params.time){switch(this.showTime(this.currentDate),this.currentView){case 1:this.initHours();break;case 2:this.initMinutes();}this.animateHands()}},_onOKClick:function(){switch(this.currentView){case 0:!0===this.params.time?this.initHours():(this.setElementValue(),this.hide());break;case 1:this.initMinutes();break;case 2:this.setElementValue(),this.hide();}},_onCancelClick:function(){if(this.params.time)switch(this.currentView){case 0:this.hide();break;case 1:this.params.date?this.initDate():this.hide();break;case 2:this.initHours();}else this.hide()},_onMonthBeforeClick:function(){this.currentDate.subtract(1,"months"),this.initDate(this.currentDate),this._closeYearPicker()},_onMonthAfterClick:function(){this.currentDate.add(1,"months"),this.initDate(this.currentDate),this._closeYearPicker()},_onYearBeforeClick:function(){this.currentDate.subtract(1,"years"),this.initDate(this.currentDate),this._closeYearPicker()},_onYearAfterClick:function(){this.currentDate.add(1,"years"),this.initDate(this.currentDate),this._closeYearPicker()},refreshYearItems:function(){var j=this.currentDate.year(),l=this.midYear,n=1850;"undefined"!=typeof this.minDate&&null!==this.minDate&&(n=b(this.minDate).year());var o=2200;"undefined"!=typeof this.maxDate&&null!==this.maxDate&&(o=b(this.maxDate).year()),this.$dtpElement.find(".dtp-picker-year .invisible").removeClass("invisible"),this.$dtpElement.find(".year-picker-item").each(function(q,t){var u=l-3+q;a(t).attr("data-year",u).text(u).data("year",u),j==u?a(t).addClass("active"):a(t).removeClass("active"),(u<n||u>o)&&a(t).addClass("invisible")}),n>=l-3&&this.$dtpElement.find(".dtp-select-year-range.before").addClass("invisible"),o<=l+3&&this.$dtpElement.find(".dtp-select-year-range.after").addClass("invisible"),this.$dtpElement.find(".dtp-select-year-range").data("mid",l)},_onActualYearClick:function(){this.params.year&&(0<this.$dtpElement.find(".dtp-picker-year.hidden").length?(this.$dtpElement.find(".dtp-picker-datetime").addClass("hidden"),this.$dtpElement.find(".dtp-picker-calendar").addClass("hidden"),this.$dtpElement.find(".dtp-picker-year").removeClass("hidden"),this.midYear=this.currentDate.year(),this.refreshYearItems()):this._closeYearPicker())},_onYearRangeBeforeClick:function(){this.midYear-=7,this.refreshYearItems()},_onYearRangeAfterClick:function(){this.midYear+=7,this.refreshYearItems()},_onYearItemClick:function(j){var l=a(j.currentTarget).data("year"),n=this.currentDate.year();this.currentDate.add(l-n,"years"),this.initDate(this.currentDate),this._closeYearPicker(),this.$element.trigger("yearSelected",this.currentDate)},_closeYearPicker:function(){this.$dtpElement.find(".dtp-picker-calendar").removeClass("hidden"),this.$dtpElement.find(".dtp-picker-year").addClass("hidden")},enableYearPicker:function(){this.params.year=!0,this.$dtpElement.find(".dtp-actual-year").reomveClass("disabled")},disableYearPicker:function(){this.params.year=!1,this.$dtpElement.find(".dtp-actual-year").addClass("disabled"),this._closeYearPicker()},_onSelectDate:function(j){this.$dtpElement.find("a.dtp-select-day").removeClass("selected"),a(j.currentTarget).addClass("selected"),this.selectDate(a(j.currentTarget).parent().data("date")),!0===this.params.switchOnClick&&!0===this.params.time&&setTimeout(this.initHours.bind(this),200),!0===this.params.switchOnClick&&!1===this.params.time&&setTimeout(this._onOKClick.bind(this),200)},_onSelectHour:function(j){if(!a(j.target).hasClass("disabled")){for(var l=a(j.target).data("hour"),n=a(j.target).parent(),o=n.find(".dtp-select-hour"),q=0;q<o.length;q++)a(o[q]).attr("fill","transparent");for(var t=n.find(".dtp-select-hour-text"),q=0;q<t.length;q++)a(t[q]).attr("fill","#000");a(n.find("#h-"+l)).attr("fill","#8BC34A"),a(n.find("#th-"+l)).attr("fill","#fff"),this.currentDate.hour(parseInt(l)),!0===this.params.shortTime&&this.isPM()&&this.currentDate.add(12,"hours"),this.showTime(this.currentDate),this.animateHands(),!0===this.params.switchOnClick&&setTimeout(this.initMinutes.bind(this),200)}},_onSelectMinute:function(j){if(!a(j.target).hasClass("disabled")){for(var l=a(j.target).data("minute"),n=a(j.target).parent(),o=n.find(".dtp-select-minute"),q=0;q<o.length;q++)a(o[q]).attr("fill","transparent");for(var t=n.find(".dtp-select-minute-text"),q=0;q<t.length;q++)a(t[q]).attr("fill","#000");a(n.find("#m-"+l)).attr("fill","#8BC34A"),a(n.find("#tm-"+l)).attr("fill","#fff"),this.currentDate.minute(parseInt(l)),this.showTime(this.currentDate),this.animateHands(),!0===this.params.switchOnClick&&setTimeout(function(){this.setElementValue(),this.hide()}.bind(this),200)}},_onSelectAM:function(j){a(".dtp-actual-meridien").find("a").removeClass("selected"),a(j.currentTarget).addClass("selected"),12<=this.currentDate.hour()&&this.currentDate.subtract(12,"hours")&&this.showTime(this.currentDate),this.toggleTime(1===this.currentView)},_onSelectPM:function(j){a(".dtp-actual-meridien").find("a").removeClass("selected"),a(j.currentTarget).addClass("selected"),12>this.currentDate.hour()&&this.currentDate.add(12,"hours")&&this.showTime(this.currentDate),this.toggleTime(1===this.currentView)},_hideCalendar:function(){this.$dtpElement.find(".dtp-picker-calendar").addClass("hidden")},convertHours:function(j){var l=j;return!0===this.params.shortTime&&12>j&&this.isPM()&&(l+=12),l},setDate:function(j){this.params.currentDate=j,this.initDates()},setMinDate:function(j){this.params.minDate=j,this.initDates()},setMaxDate:function(j){this.params.maxDate=j,this.initDates()},destroy:function(){this._detachEvents(),this.$dtpElement.remove()},show:function(){this.$dtpElement.removeClass("hidden"),this._attachEvent(a(window),"keydown",this._onKeydown.bind(this)),this._centerBox(),this.$element.trigger("open"),!0===this.params.monthPicker&&this._hideCalendar()},hide:function(){a(window).off("keydown",null,null,this._onKeydown.bind(this)),this.$dtpElement.addClass("hidden"),this.$element.trigger("close")},_centerBox:function(){var j=(this.$dtpElement.height()-this.$dtpElement.find(".dtp-content").height())/2;this.$dtpElement.find(".dtp-content").css("marginLeft",-(this.$dtpElement.find(".dtp-content").width()/2)+"px"),this.$dtpElement.find(".dtp-content").css("top",j+"px")},enableDays:function(){var j=this.params.enableDays;j&&a(".dtp-picker-days tbody tr td").each(function(){0<=a.inArray(a(this).index(),j)||a(this).find("a").css({background:"#e3e3e3",cursor:"no-drop",opacity:"0.5"}).off("click")})}}})(jQuery,moment);